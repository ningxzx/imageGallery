{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./nuxt.config.js","webpack:///./server/config/index.js","webpack:///./server/index.js","webpack:///./server/middlewares.js","webpack:///./server/routes.js","webpack:///external \"consola\"","webpack:///external \"fs\"","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-mount\"","webpack:///external \"koa-static\"","webpack:///external \"koa-trie-router\"","webpack:///external \"nuxt\"","webpack:///external \"path\""],"names":["pkg","require","module","exports","mode","head","title","name","meta","charset","content","hid","description","link","rel","type","href","loading","color","css","src","lang","plugins","modules","axios","build","extend","config","ctx","isDev","isClient","rules","push","enforce","test","exclude","app","version","server","port","static_dir","gallery","options","session","secretKey","Koa","consola","Nuxt","Builder","host","process","env","HOST","PORT","nuxtConfig","dev","start","nuxt","builder","path","resolve","__dirname","use","serve","middlewares","next","status","Promise","reject","res","on","render","req","promise","then","catch","listen","ready","message","badge","headersSent","throw","body","data","err","emit","bodyParser","mount","routes","fs","router","Router","getImageNames","files","readdir","picFiles","get","middleware"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./server/index.js\");\n","const pkg = require('./package')\n\nmodule.exports = {\n  mode: 'universal',\n\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: pkg.name,\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: pkg.description }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\n    ]\n  },\n\n  /*\n  ** Customize the progress-bar color\n  */\n  loading: { color: '#fff' },\n\n  /*\n  ** Global CSS\n  */\n  css: [\n    'element-ui/lib/theme-chalk/index.css',\n    {\n        src: 'assets/base.less',\n        lang: 'less'\n    }\n  ],\n\n  /*\n  ** Plugins to load before mounting the App\n  */\n  plugins: [\n    '@/plugins/element-ui'\n  ],\n\n  /*\n  ** Nuxt.js modules\n  */\n  modules: [\n    // Doc: https://github.com/nuxt-community/axios-module#usage\n    '@nuxtjs/axios'\n  ],\n  /*\n  ** Axios module configuration\n  */\n  axios: {\n    // See https://github.com/nuxt-community/axios-module#options\n  },\n\n  /*\n  ** Build configuration\n  */\n  build: {\n    /*\n    ** You can extend webpack config here\n    */\n    extend(config, ctx) {\n      // Run ESLint on save\n      if (ctx.isDev && ctx.isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.(js|vue)$/,\n          // loader: 'eslint-loader',\n          exclude: /(node_modules)/\n        })\n      }\n    }\n  }\n}\n","'use strict'\n\nexport default {\n  app: {\n    name: 'something',\n    version: '1.0.0'\n  },\n  server: {\n    port: 3000\n  },\n  static_dir: {\n    gallery: '../gallery',\n    options: {}\n  },\n  session: {\n    secretKey: 'something'\n  }\n}\n","const Koa = require('koa')\nconst consola = require('consola')\nconst { Nuxt, Builder } = require('nuxt')\n\nimport config from './config'\nimport middlewares from './middlewares'\nimport serve from 'koa-static'\nimport path from 'path'\n\n\nconst app = new Koa()\nconst host = process.env.HOST || '127.0.0.1'\nconst port = process.env.PORT || config.server.port\n\n// Import and Set Nuxt.js options\nlet nuxtConfig = require('../nuxt.config.js')\nnuxtConfig.dev = !(app.env === 'production')\n\nasync function start() {\n  // Instantiate nuxt.js\n  const nuxt = new Nuxt(nuxtConfig)\n\n  // Build in development\n  if (nuxtConfig.dev) {\n    const builder = new Builder(nuxt)\n    await builder.build()\n  }\n\n  // access to local file\n  const gallery = path.resolve(__dirname, config.static_dir.gallery);\n  app.use(serve(gallery))\n\n\n  // Middlewares are imported here.\n  middlewares(app)\n\n  app.use(async (ctx, next) => {\n    await next()\n    ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n\n    return new Promise((resolve, reject) => {\n      ctx.res.on('close', resolve)\n      ctx.res.on('finish', resolve)\n      nuxt.render(ctx.req, ctx.res, promise => {\n        // nuxt.render passes a rejected promise into callback on error.\n        promise.then(resolve).catch(reject)\n      })\n    })\n  })\n\n  app.listen(port, host)\n  consola.ready({\n    message: `Server listening on http://${host}:${port}`,\n    badge: true\n  })\n}\n\nstart()\n","'use strict'\n\n// All middlewares are used here.\n// Check other Koa official middlewares: https://github.com/koajs\nimport bodyParser from 'koa-bodyparser'\nimport routes from './routes'\n\nexport default (app) => {\n  // Catch and format the error in the upstream.\n  // https://github.com/koajs/koa/wiki/Error-Handling\n  app.use(async (ctx, next) => {\n    try {\n      await next()\n\n      // Handle 404 - throw it as an error.\n      if (ctx.status === 404 && ctx.res.headersSent === false) {\n        ctx.throw(404)\n      }\n\n      // Use this when you want to format the 200 res further.\n      // e.g. {\"status\":200,\"data\":{\"message\":\"Hello home sample!\"}}\n      // else, you get, e.g. {\"message\":\"Hello home sample!\"}\n      if (ctx.status === 200 && ctx.res.headersSent === false) {\n        ctx.body = {\n          status: 200,\n          data: ctx.body\n        }\n      }\n    } catch (err) {\n      ctx.status = err.status || 500\n\n      ctx.body = {\n        status: ctx.status,\n        message: err.message\n      }\n\n      ctx.app.emit('error', err, ctx)\n    }\n  })\n\n  // The parsed body will store in ctx.request.body\n  // If nothing was parsed, body will be an empty object {}\n  // https://github.com/koajs/bodyparser\n  // https://github.com/koajs/koa/issues/719\n  app.use(bodyParser())\n\n  // Add routes by group.\n  const mount = require('koa-mount')\n  app.use(mount('/api', routes(app)))\n}\n","const fs = require('fs')\nconst path = require('path')\n\n\nimport Router from 'koa-trie-router'\n\nconst router = new Router()\n\nconst gallery = path.resolve(__dirname, '../gallery/');\n\nconst getImageNames = async function (ctx, next) {\n  await next()\n  let files = []\n  await new Promise((resolve, reject) => { // 读image文件夹\n    fs.readdir(gallery, function (err, picFiles) {\n      if (err) ctx.throw(err)\n      files = picFiles\n      resolve()\n    })\n  })\n  ctx.body = files\n}\n//TODO: 文件夹递归查询\n\nexport default (app) => {\n  router.get('/images', getImageNames);\n  return router.middleware()\n}\n","module.exports = require(\"consola\");","module.exports = require(\"fs\");","module.exports = require(\"koa\");","module.exports = require(\"koa-bodyparser\");","module.exports = require(\"koa-mount\");","module.exports = require(\"koa-static\");","module.exports = require(\"koa-trie-router\");","module.exports = require(\"nuxt\");","module.exports = require(\"path\");"],"sourceRoot":""}